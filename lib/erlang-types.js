'use strict';

class Tuple {
  constructor(...args) {
    this.values = Object.freeze(args);
    this.length = this.values.length;
  }

  get(index) {
    return this.values[index];
  }

  count() {
    return this.values.length;
  }

  [Symbol.iterator]() {
    return this.values[Symbol.iterator]();
  }

  toString() {
    let i,
        s = '';
    for (i = 0; i < this.values.length; i++) {
      if (s !== '') {
        s += ', ';
      }

      const stringToAppend = this.values[i] ? this.values[i].toString() : '';

      s += stringToAppend;
    }

    return '{' + s + '}';
  }

  put_elem(index, elem) {
    if (index === this.length) {
      let new_values = this.values.concat([elem]);
      return new Tuple(...new_values);
    }

    let new_values = this.values.concat([]);
    new_values.splice(index, 0, elem);
    return new Tuple(...new_values);
  }

  remove_elem(index) {
    let new_values = this.values.concat([]);
    new_values.splice(index, 1);
    return new Tuple(...new_values);
  }
}

let process_counter = -1;

class PID {
  constructor() {
    process_counter = process_counter + 1;
    this.id = process_counter;
  }

  toString() {
    return 'PID#<0.' + this.id + '.0>';
  }
}

let ref_counter = -1;

class Reference {
  constructor() {
    ref_counter = ref_counter + 1;
    this.id = ref_counter;
    this.ref = Symbol();
  }

  toString() {
    return 'Ref#<0.0.0.' + this.id + '>';
  }
}

class BitString {
  constructor(...args) {
    this.value = Object.freeze(this.process(args));
    this.length = this.value.length;
    this.bit_size = this.length * 8;
    this.byte_size = this.length;
  }

  get(index) {
    return this.value[index];
  }

  count() {
    return this.value.length;
  }

  slice(start, end = null) {
    let s = this.value.slice(start, end);
    let ms = s.map(elem => BitString.integer(elem));
    return new BitString(...ms);
  }

  [Symbol.iterator]() {
    return this.value[Symbol.iterator]();
  }

  toString() {
    var i,
        s = '';
    for (i = 0; i < this.count(); i++) {
      if (s !== '') {
        s += ', ';
      }
      s += this.get(i).toString();
    }

    return '<<' + s + '>>';
  }

  process(bitStringParts) {
    let processed_values = [];

    var i;
    for (i = 0; i < bitStringParts.length; i++) {
      let processed_value = this['process_' + bitStringParts[i].type](bitStringParts[i]);

      for (let attr of bitStringParts[i].attributes) {
        processed_value = this['process_' + attr](processed_value);
      }

      processed_values = processed_values.concat(processed_value);
    }

    return processed_values;
  }

  process_integer(value) {
    return value.value;
  }

  process_float(value) {
    if (value.size === 64) {
      return BitString.float64ToBytes(value.value);
    } else if (value.size === 32) {
      return BitString.float32ToBytes(value.value);
    }

    throw new Error('Invalid size for float');
  }

  process_bitstring(value) {
    return value.value.value;
  }

  process_binary(value) {
    return BitString.toUTF8Array(value.value);
  }

  process_utf8(value) {
    return BitString.toUTF8Array(value.value);
  }

  process_utf16(value) {
    return BitString.toUTF16Array(value.value);
  }

  process_utf32(value) {
    return BitString.toUTF32Array(value.value);
  }

  process_signed(value) {
    return new Uint8Array([value])[0];
  }

  process_unsigned(value) {
    return value;
  }

  process_native(value) {
    return value;
  }

  process_big(value) {
    return value;
  }

  process_little(value) {
    return value.reverse();
  }

  process_size(value) {
    return value;
  }

  process_unit(value) {
    return value;
  }

  static integer(value) {
    return BitString.wrap(value, { type: 'integer', unit: 1, size: 8 });
  }

  static float(value) {
    return BitString.wrap(value, { type: 'float', unit: 1, size: 64 });
  }

  static bitstring(value) {
    return BitString.wrap(value, {
      type: 'bitstring',
      unit: 1,
      size: value.bit_size
    });
  }

  static bits(value) {
    return BitString.bitstring(value);
  }

  static binary(value) {
    return BitString.wrap(value, {
      type: 'binary',
      unit: 8,
      size: value.length
    });
  }

  static bytes(value) {
    return BitString.binary(value);
  }

  static utf8(value) {
    return BitString.wrap(value, { type: 'utf8', unit: 1, size: value.length });
  }

  static utf16(value) {
    return BitString.wrap(value, {
      type: 'utf16',
      unit: 1,
      size: value.length * 2
    });
  }

  static utf32(value) {
    return BitString.wrap(value, {
      type: 'utf32',
      unit: 1,
      size: value.length * 4
    });
  }

  static signed(value) {
    return BitString.wrap(value, {}, 'signed');
  }

  static unsigned(value) {
    return BitString.wrap(value, {}, 'unsigned');
  }

  static native(value) {
    return BitString.wrap(value, {}, 'native');
  }

  static big(value) {
    return BitString.wrap(value, {}, 'big');
  }

  static little(value) {
    return BitString.wrap(value, {}, 'little');
  }

  static size(value, count) {
    return BitString.wrap(value, { size: count });
  }

  static unit(value, count) {
    return BitString.wrap(value, { unit: count });
  }

  static wrap(value, opt, new_attribute = null) {
    let the_value = value;

    if (!(value instanceof Object)) {
      the_value = { value: value, attributes: [] };
    }

    the_value = Object.assign(the_value, opt);

    if (new_attribute) {
      the_value.attributes.push(new_attribute);
    }

    return the_value;
  }

  static toUTF8Array(str) {
    var utf8 = [];
    for (var i = 0; i < str.length; i++) {
      var charcode = str.charCodeAt(i);
      if (charcode < 0x80) {
        utf8.push(charcode);
      } else if (charcode < 0x800) {
        utf8.push(0xc0 | charcode >> 6, 0x80 | charcode & 0x3f);
      } else if (charcode < 0xd800 || charcode >= 0xe000) {
        utf8.push(0xe0 | charcode >> 12, 0x80 | charcode >> 6 & 0x3f, 0x80 | charcode & 0x3f);
      } else {
        // surrogate pair
        i++;
        // UTF-16 encodes 0x10000-0x10FFFF by
        // subtracting 0x10000 and splitting the
        // 20 bits of 0x0-0xFFFFF into two halves
        charcode = 0x10000 + ((charcode & 0x3ff) << 10 | str.charCodeAt(i) & 0x3ff);
        utf8.push(0xf0 | charcode >> 18, 0x80 | charcode >> 12 & 0x3f, 0x80 | charcode >> 6 & 0x3f, 0x80 | charcode & 0x3f);
      }
    }
    return utf8;
  }

  static toUTF16Array(str) {
    var utf16 = [];
    for (var i = 0; i < str.length; i++) {
      var codePoint = str.codePointAt(i);

      if (codePoint <= 255) {
        utf16.push(0);
        utf16.push(codePoint);
      } else {
        utf16.push(codePoint >> 8 & 0xff);
        utf16.push(codePoint & 0xff);
      }
    }
    return utf16;
  }

  static toUTF32Array(str) {
    var utf32 = [];
    for (var i = 0; i < str.length; i++) {
      var codePoint = str.codePointAt(i);

      if (codePoint <= 255) {
        utf32.push(0);
        utf32.push(0);
        utf32.push(0);
        utf32.push(codePoint);
      } else {
        utf32.push(0);
        utf32.push(0);
        utf32.push(codePoint >> 8 & 0xff);
        utf32.push(codePoint & 0xff);
      }
    }
    return utf32;
  }

  //http://stackoverflow.com/questions/2003493/javascript-float-from-to-bits
  static float32ToBytes(f) {
    var bytes = [];

    var buf = new ArrayBuffer(4);
    new Float32Array(buf)[0] = f;

    let intVersion = new Uint32Array(buf)[0];

    bytes.push(intVersion >> 24 & 0xff);
    bytes.push(intVersion >> 16 & 0xff);
    bytes.push(intVersion >> 8 & 0xff);
    bytes.push(intVersion & 0xff);

    return bytes;
  }

  static float64ToBytes(f) {
    var bytes = [];

    var buf = new ArrayBuffer(8);
    new Float64Array(buf)[0] = f;

    var intVersion1 = new Uint32Array(buf)[0];
    var intVersion2 = new Uint32Array(buf)[1];

    bytes.push(intVersion2 >> 24 & 0xff);
    bytes.push(intVersion2 >> 16 & 0xff);
    bytes.push(intVersion2 >> 8 & 0xff);
    bytes.push(intVersion2 & 0xff);

    bytes.push(intVersion1 >> 24 & 0xff);
    bytes.push(intVersion1 >> 16 & 0xff);
    bytes.push(intVersion1 >> 8 & 0xff);
    bytes.push(intVersion1 & 0xff);

    return bytes;
  }
}

var index = {
  Tuple,
  PID,
  Reference,
  BitString
};

module.exports = index;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjpudWxsLCJzb3VyY2VzIjpbIi4uL3NyYy9lcmxhbmctdHlwZXMvdHVwbGUuanMiLCIuLi9zcmMvZXJsYW5nLXR5cGVzL3BpZC5qcyIsIi4uL3NyYy9lcmxhbmctdHlwZXMvcmVmZXJlbmNlLmpzIiwiLi4vc3JjL2VybGFuZy10eXBlcy9iaXRfc3RyaW5nLmpzIiwiLi4vc3JjL2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNsYXNzIFR1cGxlIHtcbiAgY29uc3RydWN0b3IoLi4uYXJncykge1xuICAgIHRoaXMudmFsdWVzID0gT2JqZWN0LmZyZWV6ZShhcmdzKTtcbiAgICB0aGlzLmxlbmd0aCA9IHRoaXMudmFsdWVzLmxlbmd0aDtcbiAgfVxuXG4gIGdldChpbmRleCkge1xuICAgIHJldHVybiB0aGlzLnZhbHVlc1tpbmRleF07XG4gIH1cblxuICBjb3VudCgpIHtcbiAgICByZXR1cm4gdGhpcy52YWx1ZXMubGVuZ3RoO1xuICB9XG5cbiAgW1N5bWJvbC5pdGVyYXRvcl0oKSB7XG4gICAgcmV0dXJuIHRoaXMudmFsdWVzW1N5bWJvbC5pdGVyYXRvcl0oKTtcbiAgfVxuXG4gIHRvU3RyaW5nKCkge1xuICAgIGxldCBpLFxuICAgICAgcyA9ICcnO1xuICAgIGZvciAoaSA9IDA7IGkgPCB0aGlzLnZhbHVlcy5sZW5ndGg7IGkrKykge1xuICAgICAgaWYgKHMgIT09ICcnKSB7XG4gICAgICAgIHMgKz0gJywgJztcbiAgICAgIH1cblxuICAgICAgY29uc3Qgc3RyaW5nVG9BcHBlbmQgPSB0aGlzLnZhbHVlc1tpXSA/IHRoaXMudmFsdWVzW2ldLnRvU3RyaW5nKCkgOiAnJztcblxuICAgICAgcyArPSBzdHJpbmdUb0FwcGVuZDtcbiAgICB9XG5cbiAgICByZXR1cm4gJ3snICsgcyArICd9JztcbiAgfVxuXG4gIHB1dF9lbGVtKGluZGV4LCBlbGVtKSB7XG4gICAgaWYgKGluZGV4ID09PSB0aGlzLmxlbmd0aCkge1xuICAgICAgbGV0IG5ld192YWx1ZXMgPSB0aGlzLnZhbHVlcy5jb25jYXQoW2VsZW1dKTtcbiAgICAgIHJldHVybiBuZXcgVHVwbGUoLi4ubmV3X3ZhbHVlcyk7XG4gICAgfVxuXG4gICAgbGV0IG5ld192YWx1ZXMgPSB0aGlzLnZhbHVlcy5jb25jYXQoW10pO1xuICAgIG5ld192YWx1ZXMuc3BsaWNlKGluZGV4LCAwLCBlbGVtKTtcbiAgICByZXR1cm4gbmV3IFR1cGxlKC4uLm5ld192YWx1ZXMpO1xuICB9XG5cbiAgcmVtb3ZlX2VsZW0oaW5kZXgpIHtcbiAgICBsZXQgbmV3X3ZhbHVlcyA9IHRoaXMudmFsdWVzLmNvbmNhdChbXSk7XG4gICAgbmV3X3ZhbHVlcy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgIHJldHVybiBuZXcgVHVwbGUoLi4ubmV3X3ZhbHVlcyk7XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgVHVwbGU7XG4iLCJsZXQgcHJvY2Vzc19jb3VudGVyID0gLTE7XG5cbmNsYXNzIFBJRCB7XG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHByb2Nlc3NfY291bnRlciA9IHByb2Nlc3NfY291bnRlciArIDE7XG4gICAgdGhpcy5pZCA9IHByb2Nlc3NfY291bnRlcjtcbiAgfVxuXG4gIHRvU3RyaW5nKCkge1xuICAgIHJldHVybiAnUElEIzwwLicgKyB0aGlzLmlkICsgJy4wPic7XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgUElEO1xuIiwibGV0IHJlZl9jb3VudGVyID0gLTE7XG5cbmNsYXNzIFJlZmVyZW5jZSB7XG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHJlZl9jb3VudGVyID0gcmVmX2NvdW50ZXIgKyAxO1xuICAgIHRoaXMuaWQgPSByZWZfY291bnRlcjtcbiAgICB0aGlzLnJlZiA9IFN5bWJvbCgpO1xuICB9XG5cbiAgdG9TdHJpbmcoKSB7XG4gICAgcmV0dXJuICdSZWYjPDAuMC4wLicgKyB0aGlzLmlkICsgJz4nO1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IFJlZmVyZW5jZTtcbiIsImNsYXNzIEJpdFN0cmluZyB7XG4gIGNvbnN0cnVjdG9yKC4uLmFyZ3MpIHtcbiAgICB0aGlzLnZhbHVlID0gT2JqZWN0LmZyZWV6ZSh0aGlzLnByb2Nlc3MoYXJncykpO1xuICAgIHRoaXMubGVuZ3RoID0gdGhpcy52YWx1ZS5sZW5ndGg7XG4gICAgdGhpcy5iaXRfc2l6ZSA9IHRoaXMubGVuZ3RoICogODtcbiAgICB0aGlzLmJ5dGVfc2l6ZSA9IHRoaXMubGVuZ3RoO1xuICB9XG5cbiAgZ2V0KGluZGV4KSB7XG4gICAgcmV0dXJuIHRoaXMudmFsdWVbaW5kZXhdO1xuICB9XG5cbiAgY291bnQoKSB7XG4gICAgcmV0dXJuIHRoaXMudmFsdWUubGVuZ3RoO1xuICB9XG5cbiAgc2xpY2Uoc3RhcnQsIGVuZCA9IG51bGwpIHtcbiAgICBsZXQgcyA9IHRoaXMudmFsdWUuc2xpY2Uoc3RhcnQsIGVuZCk7XG4gICAgbGV0IG1zID0gcy5tYXAoZWxlbSA9PiBCaXRTdHJpbmcuaW50ZWdlcihlbGVtKSk7XG4gICAgcmV0dXJuIG5ldyBCaXRTdHJpbmcoLi4ubXMpO1xuICB9XG5cbiAgW1N5bWJvbC5pdGVyYXRvcl0oKSB7XG4gICAgcmV0dXJuIHRoaXMudmFsdWVbU3ltYm9sLml0ZXJhdG9yXSgpO1xuICB9XG5cbiAgdG9TdHJpbmcoKSB7XG4gICAgdmFyIGksXG4gICAgICBzID0gJyc7XG4gICAgZm9yIChpID0gMDsgaSA8IHRoaXMuY291bnQoKTsgaSsrKSB7XG4gICAgICBpZiAocyAhPT0gJycpIHtcbiAgICAgICAgcyArPSAnLCAnO1xuICAgICAgfVxuICAgICAgcyArPSB0aGlzLmdldChpKS50b1N0cmluZygpO1xuICAgIH1cblxuICAgIHJldHVybiAnPDwnICsgcyArICc+Pic7XG4gIH1cblxuICBwcm9jZXNzKGJpdFN0cmluZ1BhcnRzKSB7XG4gICAgbGV0IHByb2Nlc3NlZF92YWx1ZXMgPSBbXTtcblxuICAgIHZhciBpO1xuICAgIGZvciAoaSA9IDA7IGkgPCBiaXRTdHJpbmdQYXJ0cy5sZW5ndGg7IGkrKykge1xuICAgICAgbGV0IHByb2Nlc3NlZF92YWx1ZSA9IHRoaXNbJ3Byb2Nlc3NfJyArIGJpdFN0cmluZ1BhcnRzW2ldLnR5cGVdKFxuICAgICAgICBiaXRTdHJpbmdQYXJ0c1tpXVxuICAgICAgKTtcblxuICAgICAgZm9yIChsZXQgYXR0ciBvZiBiaXRTdHJpbmdQYXJ0c1tpXS5hdHRyaWJ1dGVzKSB7XG4gICAgICAgIHByb2Nlc3NlZF92YWx1ZSA9IHRoaXNbJ3Byb2Nlc3NfJyArIGF0dHJdKHByb2Nlc3NlZF92YWx1ZSk7XG4gICAgICB9XG5cbiAgICAgIHByb2Nlc3NlZF92YWx1ZXMgPSBwcm9jZXNzZWRfdmFsdWVzLmNvbmNhdChwcm9jZXNzZWRfdmFsdWUpO1xuICAgIH1cblxuICAgIHJldHVybiBwcm9jZXNzZWRfdmFsdWVzO1xuICB9XG5cbiAgcHJvY2Vzc19pbnRlZ2VyKHZhbHVlKSB7XG4gICAgcmV0dXJuIHZhbHVlLnZhbHVlO1xuICB9XG5cbiAgcHJvY2Vzc19mbG9hdCh2YWx1ZSkge1xuICAgIGlmICh2YWx1ZS5zaXplID09PSA2NCkge1xuICAgICAgcmV0dXJuIEJpdFN0cmluZy5mbG9hdDY0VG9CeXRlcyh2YWx1ZS52YWx1ZSk7XG4gICAgfSBlbHNlIGlmICh2YWx1ZS5zaXplID09PSAzMikge1xuICAgICAgcmV0dXJuIEJpdFN0cmluZy5mbG9hdDMyVG9CeXRlcyh2YWx1ZS52YWx1ZSk7XG4gICAgfVxuXG4gICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIHNpemUgZm9yIGZsb2F0Jyk7XG4gIH1cblxuICBwcm9jZXNzX2JpdHN0cmluZyh2YWx1ZSkge1xuICAgIHJldHVybiB2YWx1ZS52YWx1ZS52YWx1ZTtcbiAgfVxuXG4gIHByb2Nlc3NfYmluYXJ5KHZhbHVlKSB7XG4gICAgcmV0dXJuIEJpdFN0cmluZy50b1VURjhBcnJheSh2YWx1ZS52YWx1ZSk7XG4gIH1cblxuICBwcm9jZXNzX3V0ZjgodmFsdWUpIHtcbiAgICByZXR1cm4gQml0U3RyaW5nLnRvVVRGOEFycmF5KHZhbHVlLnZhbHVlKTtcbiAgfVxuXG4gIHByb2Nlc3NfdXRmMTYodmFsdWUpIHtcbiAgICByZXR1cm4gQml0U3RyaW5nLnRvVVRGMTZBcnJheSh2YWx1ZS52YWx1ZSk7XG4gIH1cblxuICBwcm9jZXNzX3V0ZjMyKHZhbHVlKSB7XG4gICAgcmV0dXJuIEJpdFN0cmluZy50b1VURjMyQXJyYXkodmFsdWUudmFsdWUpO1xuICB9XG5cbiAgcHJvY2Vzc19zaWduZWQodmFsdWUpIHtcbiAgICByZXR1cm4gbmV3IFVpbnQ4QXJyYXkoW3ZhbHVlXSlbMF07XG4gIH1cblxuICBwcm9jZXNzX3Vuc2lnbmVkKHZhbHVlKSB7XG4gICAgcmV0dXJuIHZhbHVlO1xuICB9XG5cbiAgcHJvY2Vzc19uYXRpdmUodmFsdWUpIHtcbiAgICByZXR1cm4gdmFsdWU7XG4gIH1cblxuICBwcm9jZXNzX2JpZyh2YWx1ZSkge1xuICAgIHJldHVybiB2YWx1ZTtcbiAgfVxuXG4gIHByb2Nlc3NfbGl0dGxlKHZhbHVlKSB7XG4gICAgcmV0dXJuIHZhbHVlLnJldmVyc2UoKTtcbiAgfVxuXG4gIHByb2Nlc3Nfc2l6ZSh2YWx1ZSkge1xuICAgIHJldHVybiB2YWx1ZTtcbiAgfVxuXG4gIHByb2Nlc3NfdW5pdCh2YWx1ZSkge1xuICAgIHJldHVybiB2YWx1ZTtcbiAgfVxuXG4gIHN0YXRpYyBpbnRlZ2VyKHZhbHVlKSB7XG4gICAgcmV0dXJuIEJpdFN0cmluZy53cmFwKHZhbHVlLCB7IHR5cGU6ICdpbnRlZ2VyJywgdW5pdDogMSwgc2l6ZTogOCB9KTtcbiAgfVxuXG4gIHN0YXRpYyBmbG9hdCh2YWx1ZSkge1xuICAgIHJldHVybiBCaXRTdHJpbmcud3JhcCh2YWx1ZSwgeyB0eXBlOiAnZmxvYXQnLCB1bml0OiAxLCBzaXplOiA2NCB9KTtcbiAgfVxuXG4gIHN0YXRpYyBiaXRzdHJpbmcodmFsdWUpIHtcbiAgICByZXR1cm4gQml0U3RyaW5nLndyYXAodmFsdWUsIHtcbiAgICAgIHR5cGU6ICdiaXRzdHJpbmcnLFxuICAgICAgdW5pdDogMSxcbiAgICAgIHNpemU6IHZhbHVlLmJpdF9zaXplLFxuICAgIH0pO1xuICB9XG5cbiAgc3RhdGljIGJpdHModmFsdWUpIHtcbiAgICByZXR1cm4gQml0U3RyaW5nLmJpdHN0cmluZyh2YWx1ZSk7XG4gIH1cblxuICBzdGF0aWMgYmluYXJ5KHZhbHVlKSB7XG4gICAgcmV0dXJuIEJpdFN0cmluZy53cmFwKHZhbHVlLCB7XG4gICAgICB0eXBlOiAnYmluYXJ5JyxcbiAgICAgIHVuaXQ6IDgsXG4gICAgICBzaXplOiB2YWx1ZS5sZW5ndGgsXG4gICAgfSk7XG4gIH1cblxuICBzdGF0aWMgYnl0ZXModmFsdWUpIHtcbiAgICByZXR1cm4gQml0U3RyaW5nLmJpbmFyeSh2YWx1ZSk7XG4gIH1cblxuICBzdGF0aWMgdXRmOCh2YWx1ZSkge1xuICAgIHJldHVybiBCaXRTdHJpbmcud3JhcCh2YWx1ZSwgeyB0eXBlOiAndXRmOCcsIHVuaXQ6IDEsIHNpemU6IHZhbHVlLmxlbmd0aCB9KTtcbiAgfVxuXG4gIHN0YXRpYyB1dGYxNih2YWx1ZSkge1xuICAgIHJldHVybiBCaXRTdHJpbmcud3JhcCh2YWx1ZSwge1xuICAgICAgdHlwZTogJ3V0ZjE2JyxcbiAgICAgIHVuaXQ6IDEsXG4gICAgICBzaXplOiB2YWx1ZS5sZW5ndGggKiAyLFxuICAgIH0pO1xuICB9XG5cbiAgc3RhdGljIHV0ZjMyKHZhbHVlKSB7XG4gICAgcmV0dXJuIEJpdFN0cmluZy53cmFwKHZhbHVlLCB7XG4gICAgICB0eXBlOiAndXRmMzInLFxuICAgICAgdW5pdDogMSxcbiAgICAgIHNpemU6IHZhbHVlLmxlbmd0aCAqIDQsXG4gICAgfSk7XG4gIH1cblxuICBzdGF0aWMgc2lnbmVkKHZhbHVlKSB7XG4gICAgcmV0dXJuIEJpdFN0cmluZy53cmFwKHZhbHVlLCB7fSwgJ3NpZ25lZCcpO1xuICB9XG5cbiAgc3RhdGljIHVuc2lnbmVkKHZhbHVlKSB7XG4gICAgcmV0dXJuIEJpdFN0cmluZy53cmFwKHZhbHVlLCB7fSwgJ3Vuc2lnbmVkJyk7XG4gIH1cblxuICBzdGF0aWMgbmF0aXZlKHZhbHVlKSB7XG4gICAgcmV0dXJuIEJpdFN0cmluZy53cmFwKHZhbHVlLCB7fSwgJ25hdGl2ZScpO1xuICB9XG5cbiAgc3RhdGljIGJpZyh2YWx1ZSkge1xuICAgIHJldHVybiBCaXRTdHJpbmcud3JhcCh2YWx1ZSwge30sICdiaWcnKTtcbiAgfVxuXG4gIHN0YXRpYyBsaXR0bGUodmFsdWUpIHtcbiAgICByZXR1cm4gQml0U3RyaW5nLndyYXAodmFsdWUsIHt9LCAnbGl0dGxlJyk7XG4gIH1cblxuICBzdGF0aWMgc2l6ZSh2YWx1ZSwgY291bnQpIHtcbiAgICByZXR1cm4gQml0U3RyaW5nLndyYXAodmFsdWUsIHsgc2l6ZTogY291bnQgfSk7XG4gIH1cblxuICBzdGF0aWMgdW5pdCh2YWx1ZSwgY291bnQpIHtcbiAgICByZXR1cm4gQml0U3RyaW5nLndyYXAodmFsdWUsIHsgdW5pdDogY291bnQgfSk7XG4gIH1cblxuICBzdGF0aWMgd3JhcCh2YWx1ZSwgb3B0LCBuZXdfYXR0cmlidXRlID0gbnVsbCkge1xuICAgIGxldCB0aGVfdmFsdWUgPSB2YWx1ZTtcblxuICAgIGlmICghKHZhbHVlIGluc3RhbmNlb2YgT2JqZWN0KSkge1xuICAgICAgdGhlX3ZhbHVlID0geyB2YWx1ZTogdmFsdWUsIGF0dHJpYnV0ZXM6IFtdIH07XG4gICAgfVxuXG4gICAgdGhlX3ZhbHVlID0gT2JqZWN0LmFzc2lnbih0aGVfdmFsdWUsIG9wdCk7XG5cbiAgICBpZiAobmV3X2F0dHJpYnV0ZSkge1xuICAgICAgdGhlX3ZhbHVlLmF0dHJpYnV0ZXMucHVzaChuZXdfYXR0cmlidXRlKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhlX3ZhbHVlO1xuICB9XG5cbiAgc3RhdGljIHRvVVRGOEFycmF5KHN0cikge1xuICAgIHZhciB1dGY4ID0gW107XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzdHIubGVuZ3RoOyBpKyspIHtcbiAgICAgIHZhciBjaGFyY29kZSA9IHN0ci5jaGFyQ29kZUF0KGkpO1xuICAgICAgaWYgKGNoYXJjb2RlIDwgMHg4MCkge1xuICAgICAgICB1dGY4LnB1c2goY2hhcmNvZGUpO1xuICAgICAgfSBlbHNlIGlmIChjaGFyY29kZSA8IDB4ODAwKSB7XG4gICAgICAgIHV0ZjgucHVzaCgweGMwIHwgKGNoYXJjb2RlID4+IDYpLCAweDgwIHwgKGNoYXJjb2RlICYgMHgzZikpO1xuICAgICAgfSBlbHNlIGlmIChjaGFyY29kZSA8IDB4ZDgwMCB8fCBjaGFyY29kZSA+PSAweGUwMDApIHtcbiAgICAgICAgdXRmOC5wdXNoKFxuICAgICAgICAgIDB4ZTAgfCAoY2hhcmNvZGUgPj4gMTIpLFxuICAgICAgICAgIDB4ODAgfCAoKGNoYXJjb2RlID4+IDYpICYgMHgzZiksXG4gICAgICAgICAgMHg4MCB8IChjaGFyY29kZSAmIDB4M2YpXG4gICAgICAgICk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBzdXJyb2dhdGUgcGFpclxuICAgICAgICBpKys7XG4gICAgICAgIC8vIFVURi0xNiBlbmNvZGVzIDB4MTAwMDAtMHgxMEZGRkYgYnlcbiAgICAgICAgLy8gc3VidHJhY3RpbmcgMHgxMDAwMCBhbmQgc3BsaXR0aW5nIHRoZVxuICAgICAgICAvLyAyMCBiaXRzIG9mIDB4MC0weEZGRkZGIGludG8gdHdvIGhhbHZlc1xuICAgICAgICBjaGFyY29kZSA9XG4gICAgICAgICAgMHgxMDAwMCArICgoKGNoYXJjb2RlICYgMHgzZmYpIDw8IDEwKSB8IChzdHIuY2hhckNvZGVBdChpKSAmIDB4M2ZmKSk7XG4gICAgICAgIHV0ZjgucHVzaChcbiAgICAgICAgICAweGYwIHwgKGNoYXJjb2RlID4+IDE4KSxcbiAgICAgICAgICAweDgwIHwgKChjaGFyY29kZSA+PiAxMikgJiAweDNmKSxcbiAgICAgICAgICAweDgwIHwgKChjaGFyY29kZSA+PiA2KSAmIDB4M2YpLFxuICAgICAgICAgIDB4ODAgfCAoY2hhcmNvZGUgJiAweDNmKVxuICAgICAgICApO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdXRmODtcbiAgfVxuXG4gIHN0YXRpYyB0b1VURjE2QXJyYXkoc3RyKSB7XG4gICAgdmFyIHV0ZjE2ID0gW107XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzdHIubGVuZ3RoOyBpKyspIHtcbiAgICAgIHZhciBjb2RlUG9pbnQgPSBzdHIuY29kZVBvaW50QXQoaSk7XG5cbiAgICAgIGlmIChjb2RlUG9pbnQgPD0gMjU1KSB7XG4gICAgICAgIHV0ZjE2LnB1c2goMCk7XG4gICAgICAgIHV0ZjE2LnB1c2goY29kZVBvaW50KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHV0ZjE2LnB1c2goKGNvZGVQb2ludCA+PiA4KSAmIDB4ZmYpO1xuICAgICAgICB1dGYxNi5wdXNoKGNvZGVQb2ludCAmIDB4ZmYpO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdXRmMTY7XG4gIH1cblxuICBzdGF0aWMgdG9VVEYzMkFycmF5KHN0cikge1xuICAgIHZhciB1dGYzMiA9IFtdO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc3RyLmxlbmd0aDsgaSsrKSB7XG4gICAgICB2YXIgY29kZVBvaW50ID0gc3RyLmNvZGVQb2ludEF0KGkpO1xuXG4gICAgICBpZiAoY29kZVBvaW50IDw9IDI1NSkge1xuICAgICAgICB1dGYzMi5wdXNoKDApO1xuICAgICAgICB1dGYzMi5wdXNoKDApO1xuICAgICAgICB1dGYzMi5wdXNoKDApO1xuICAgICAgICB1dGYzMi5wdXNoKGNvZGVQb2ludCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB1dGYzMi5wdXNoKDApO1xuICAgICAgICB1dGYzMi5wdXNoKDApO1xuICAgICAgICB1dGYzMi5wdXNoKChjb2RlUG9pbnQgPj4gOCkgJiAweGZmKTtcbiAgICAgICAgdXRmMzIucHVzaChjb2RlUG9pbnQgJiAweGZmKTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHV0ZjMyO1xuICB9XG5cbiAgLy9odHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzIwMDM0OTMvamF2YXNjcmlwdC1mbG9hdC1mcm9tLXRvLWJpdHNcbiAgc3RhdGljIGZsb2F0MzJUb0J5dGVzKGYpIHtcbiAgICB2YXIgYnl0ZXMgPSBbXTtcblxuICAgIHZhciBidWYgPSBuZXcgQXJyYXlCdWZmZXIoNCk7XG4gICAgbmV3IEZsb2F0MzJBcnJheShidWYpWzBdID0gZjtcblxuICAgIGxldCBpbnRWZXJzaW9uID0gbmV3IFVpbnQzMkFycmF5KGJ1ZilbMF07XG5cbiAgICBieXRlcy5wdXNoKChpbnRWZXJzaW9uID4+IDI0KSAmIDB4ZmYpO1xuICAgIGJ5dGVzLnB1c2goKGludFZlcnNpb24gPj4gMTYpICYgMHhmZik7XG4gICAgYnl0ZXMucHVzaCgoaW50VmVyc2lvbiA+PiA4KSAmIDB4ZmYpO1xuICAgIGJ5dGVzLnB1c2goaW50VmVyc2lvbiAmIDB4ZmYpO1xuXG4gICAgcmV0dXJuIGJ5dGVzO1xuICB9XG5cbiAgc3RhdGljIGZsb2F0NjRUb0J5dGVzKGYpIHtcbiAgICB2YXIgYnl0ZXMgPSBbXTtcblxuICAgIHZhciBidWYgPSBuZXcgQXJyYXlCdWZmZXIoOCk7XG4gICAgbmV3IEZsb2F0NjRBcnJheShidWYpWzBdID0gZjtcblxuICAgIHZhciBpbnRWZXJzaW9uMSA9IG5ldyBVaW50MzJBcnJheShidWYpWzBdO1xuICAgIHZhciBpbnRWZXJzaW9uMiA9IG5ldyBVaW50MzJBcnJheShidWYpWzFdO1xuXG4gICAgYnl0ZXMucHVzaCgoaW50VmVyc2lvbjIgPj4gMjQpICYgMHhmZik7XG4gICAgYnl0ZXMucHVzaCgoaW50VmVyc2lvbjIgPj4gMTYpICYgMHhmZik7XG4gICAgYnl0ZXMucHVzaCgoaW50VmVyc2lvbjIgPj4gOCkgJiAweGZmKTtcbiAgICBieXRlcy5wdXNoKGludFZlcnNpb24yICYgMHhmZik7XG5cbiAgICBieXRlcy5wdXNoKChpbnRWZXJzaW9uMSA+PiAyNCkgJiAweGZmKTtcbiAgICBieXRlcy5wdXNoKChpbnRWZXJzaW9uMSA+PiAxNikgJiAweGZmKTtcbiAgICBieXRlcy5wdXNoKChpbnRWZXJzaW9uMSA+PiA4KSAmIDB4ZmYpO1xuICAgIGJ5dGVzLnB1c2goaW50VmVyc2lvbjEgJiAweGZmKTtcblxuICAgIHJldHVybiBieXRlcztcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBCaXRTdHJpbmc7XG4iLCJpbXBvcnQgVHVwbGUgZnJvbSAnLi9lcmxhbmctdHlwZXMvdHVwbGUuanMnO1xuaW1wb3J0IFBJRCBmcm9tICcuL2VybGFuZy10eXBlcy9waWQuanMnO1xuaW1wb3J0IFJlZmVyZW5jZSBmcm9tICcuL2VybGFuZy10eXBlcy9yZWZlcmVuY2UuanMnO1xuaW1wb3J0IEJpdFN0cmluZyBmcm9tICcuL2VybGFuZy10eXBlcy9iaXRfc3RyaW5nLmpzJztcblxuZXhwb3J0IGRlZmF1bHQge1xuICBUdXBsZSxcbiAgUElELFxuICBSZWZlcmVuY2UsXG4gIEJpdFN0cmluZyxcbn07XG4iXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSxNQUFNLEtBQU4sQ0FBWTtjQUNFLEdBQUcsSUFBZixFQUFxQjtTQUNkLE1BQUwsR0FBYyxPQUFPLE1BQVAsQ0FBYyxJQUFkLENBQWQ7U0FDSyxNQUFMLEdBQWMsS0FBSyxNQUFMLENBQVksTUFBMUI7OztNQUdFLEtBQUosRUFBVztXQUNGLEtBQUssTUFBTCxDQUFZLEtBQVosQ0FBUDs7O1VBR007V0FDQyxLQUFLLE1BQUwsQ0FBWSxNQUFuQjs7O0dBR0QsT0FBTyxRQUFSLElBQW9CO1dBQ1gsS0FBSyxNQUFMLENBQVksT0FBTyxRQUFuQixHQUFQOzs7YUFHUztRQUNMLENBQUo7UUFDRSxJQUFJLEVBRE47U0FFSyxJQUFJLENBQVQsRUFBWSxJQUFJLEtBQUssTUFBTCxDQUFZLE1BQTVCLEVBQW9DLEdBQXBDLEVBQXlDO1VBQ25DLE1BQU0sRUFBVixFQUFjO2FBQ1AsSUFBTDs7O1lBR0ksaUJBQWlCLEtBQUssTUFBTCxDQUFZLENBQVosSUFBaUIsS0FBSyxNQUFMLENBQVksQ0FBWixFQUFlLFFBQWYsRUFBakIsR0FBNkMsRUFBcEU7O1dBRUssY0FBTDs7O1dBR0ssTUFBTSxD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